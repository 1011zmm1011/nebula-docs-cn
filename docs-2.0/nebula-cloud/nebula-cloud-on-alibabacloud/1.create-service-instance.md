# 创建服务实例

在使用 NebulaGraph Cloud 阿里云版服务前，要先在阿里云控制台创建服务实例。

!!! caution

    通过 NebulaGraph Cloud 阿里云版创建的 NebulaGraph、Nebula Dashboard 和 Nebula Explorer 等服务都是企业版，试用期 14 天。如需长期使用，发送邮件[申请正式许可证](mailto:inquiry@vesoft.com)，之后[续期许可证](../../4.deployment-and-installation/deploy-license.md#nebula_graph_license_3)。

## 前提条件

- 准备[阿里云账号](https://help.aliyun.com/document_detail/324606.html)。

- 如果使用 RAM 用户创建实例，需为其添加以下权限：

  - AliyunECSFullAccess
  - AliyunVPCFullAccess
  - AliyunROSFullAccess
  - AliyunCloudMonitorFullAccess
  - AliyunComputeNestUserFullAccess

## 选择套餐

NebulaGraph Cloud 阿里云版支持多个版本的套餐，套餐配置如下表所示。在创建服务实例前，根据需求确认创建时需要选择的套餐。

| 配置项 | 基础版 | 标准版 | 高可用版 |
| - | - | - | - |
| Graph 节点数量 | 1（混合部署） | 1 | 3 |
| Graph 节点 CPU 核数 | 4（集群共享） | 16 | 16 |
| Graph 节点内存空间 | 16 GB（集群共享） | 64 GB | 64 GB |
| Graph 节点硬盘空间 | 自定义（集群共享） | 20 GB | 20 GB |
| Storage 节点数量 | 1（混合部署） | 自定义 | 自定义 |
| Storage 节点 CPU 核数 | 4（集群共享） | 16 | 16 |
| Storage 节点内存空间 | 16 GB（集群共享） | 32 GB | 32 GB |
| Storage 节点硬盘空间 | 自定义（集群共享） | 自定义 | 自定义 |
| Explorer 节点数量 | 1（混合部署） | 1 | 1 |
| Explorer CPU 核数 | 4（集群共享） | 4 | 16 |
| Explorer 内存空间 | 16 GB（集群共享） | 32 GB | 64 GB |
| Explorer 硬盘空间 | 自定义（集群共享） | 100 GB | 100 GB |
| Dashboard 节点数量 | 1（混合部署） | 1 | 1 |
| Dashboard CPU 核数 | 4（集群共享） | 4 | 16 |
| Dashboard 内存空间 | 16 GB（集群共享） | 32 GB | 64 GB |
| Dashboard 硬盘空间 | 自定义（集群共享） | 100 GB | 100 GB |

!!! note

    基础版套餐将所有 NebulaGraph 服务节点部署在同一台 ECS 服务器上。

## 创建付费版服务实例

付费版服务实例创建在用户的阿里云账号下，资源费用由用户承担。实例内 NebulaGraph 相关服务的许可证到期后，其中的数据仍然保留在用户的阿里云资源中。

付费版服务实例的创建步骤如下。

1. 登录阿里云计算巢[推荐服务](https://computenest.console.aliyun.com/user/cn-hangzhou/recommendService)页面，搜索 **NebulaGraph**。

2. 在 **NebulaGraph 集群版**卡片上，单击**云市场购买**。

3. 在云市场的 **NebulaGraph Enterprise** 产品页，选择**套餐版本**和**购买时长**（即 NebulaGraph 服务的许可证有效期），并单击**立即购买**。

  !!! caution

        当前云市场显示的价格并非实际售价，购买时需通过右侧的钉钉客服确认实际价格。

4. 在**确认订单**页面，选择要创建实例的**地域**。

5. 在**基本信息配置**区域，完成以下设置。

  1. 选择 NebulaGraph 版本。
  2. 设置 NebulaGraph 集群名称。
  3. 设置实例密码，即 NebulaGraph 集群中 ECS 服务器的登录密码。

6. 在**集群配置**或 **NebulaGraph 配置**区域，完成数据盘相关设置。

  不同套餐需要设置的内容有所区别，根据界面说明完成设置。

7. 在**基础设施配置**区域，完成以下设置。

  1. 选择**专有网络 VPC 实例 ID**。
  
    如果下拉列表为空，先单击其右侧的**新建专有网络**，完成专有网络创建。

  2. 选择**交换机可用区**。

  3. 选择**业务网络交换机的实例 ID**。
  
    如果下拉列表为空，先单击其右侧的**新建交换机**，完成交换机创建。

8. 在**温馨提示**中，选中**我同意告知服务商我的联系方式**，

9. 在**确认订单**页面底部，单击**我已接受协议，前往支付**。

10. 在**支付**页面，选择支付方式，之后单击页面底部的**支付**。

11. 在**支付完成**页面，单击**管理控制台**。

12. 在**已购买的服务**页面，单击要创建的实例右侧的**立即进入计算巢部署或查看部署详情**。

13. 在计算巢的**服务实例详情**页面，单击**基本信息**区域**状态**右侧的**部署**，并在弹出的对话框中单击**确定部署**。

14. 监控实例状态，直到部署完成。平均部署耗时为 10 分钟。

## 创建免费版试用版服务实例

免费试用版服务实例使用的资源属于阿里云，资源费用由阿里云承担。实例内 NebulaGraph 相关服务的许可证到期后，其中的数据仍然保留在试用的阿里云资源中，直到资源过期。资源的试用时间为 30 天，到期后资源内保存的数据不保留。

!!! danger
    免费试用实例不可在生产环境中使用。

免费试用版服务实例的创建步骤如下。

1. 登录阿里云计算巢[推荐服务](https://computenest.console.aliyun.com/user/cn-hangzhou/recommendService)页面，搜索 **NebulaGraph**。

2. 在 **NebulaGraph 集群版**卡片上，单击**免费试用**。

3. 系统会为首次创建 NebulaGraph 服务实例的用户弹出申请对话框。在**申请权限**对话框中填写申请人信息。带有红色星号（*）的为必填项。

  申请通过后才能继续执行以下步骤。

4. 选择模板。**集群部署**模板支持标准版和高可用版套餐，**单机部署**模板支持基础版套餐。

5. 设置服务实例名称。

6. 选择要创建实例的**地域**。

7. 在**基本信息配置**区域，完成以下设置。

  1. 选择 NebulaGraph 版本。
  2. 设置 NebulaGraph 集群名称。
  3. 设置实例密码，即 NebulaGraph 集群中 ECS 服务器的登录密码。

8. 在**套餐选择**区域，根据需要选择套餐版本。

9. 在**集群配置**或 **NebulaGraph 配置**区域，完成数据盘相关设置。

  不同套餐需要设置的内容有所区别，根据界面说明完成设置。
  
10. 在**基础设施配置**区域，选择**交换机可用区**。

11. 根据需要配置**标签和资源组**。详情参见[什么是资源管理](https://help.aliyun.com/document_detail/94475.html)。

12. 完成**权限确认**，并选中**我同意授权服务商（杭州悦数科技有限公司）获取上述权限以提供代运维服务**。

13. 在页面底部，选中**我已阅读并同意《计算巢服务协议》**，并单击**开始免费试用**。

14. 在**创建**对话框，完成信息确认并单击**确定**。

15. 在**提交成功**页面，单击去列表查看。

16. 在实例列表中查看目标实例的**状态**，确保状态为**部署中**。

  部署的平均耗时为 10 分钟。完成后实例的状态变为**已部署**。

## 常见问题

Q：服务实例的状态显示为**部署失败**怎么处理？

1. 如果使用 RAM 账号创建的实例，确认为该账号授予了本文前提条件中指定的权限。
2. 如果权限符合要求，[删除](https://help.aliyun.com/document_detail/290837.html)创建失败的实例，尝试重新创建。
3. 如果仍然创建失败，到 [NebulaGraph 论坛](https://discuss.nebula-graph.com.cn/)寻求帮助。
